/*!
 * @license
 * yii2-queue-manager-client 0.1.0 <https://github.com/somov/yii2-queue-manager-client#readme>
 * Copyright: somov.nn@gmail.com
 * Licensed under MIT
 */
!function(e,t){function n(e){return e&&'object'==typeof e&&'default'in e?e:{default:e}}var r=n(e),a=n(t);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,'value'in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function o(e){if(void 0===e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return e}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,l(e,t)}function c(e,t,n){if(!t.has(e))throw new TypeError('attempted to '+n+' private field on non-instance');return t.get(e)}function f(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError('attempted to set read only private field');t.value=n}}(e,c(e,t,'set'),n),n}function h(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,c(e,t,'get'))}function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}for(var p,v={prefixed:!0},m=[['requestFullscreen','exitFullscreen','fullscreenElement','fullscreenEnabled','fullscreenchange','fullscreenerror','fullscreen'],['webkitRequestFullscreen','webkitExitFullscreen','webkitFullscreenElement','webkitFullscreenEnabled','webkitfullscreenchange','webkitfullscreenerror','-webkit-full-screen'],['mozRequestFullScreen','mozCancelFullScreen','mozFullScreenElement','mozFullScreenEnabled','mozfullscreenchange','mozfullscreenerror','-moz-full-screen'],['msRequestFullscreen','msExitFullscreen','msFullscreenElement','msFullscreenEnabled','MSFullscreenChange','MSFullscreenError','-ms-fullscreen']],g=m[0],y=0;y<m.length;y++)if(m[y][1]in r.default){p=m[y];break}if(p){for(var w=0;w<p.length;w++)v[g[w]]=p[w];v.prefixed=p[0]!==g[0]}var b=Object.prototype.toString;function E(e,t){(e=>k(e)?Object.keys(e):[])(e).forEach((n=>t(e[n],n)))}function k(e){return!!e&&'object'==typeof e}function T(e,t){if(!e||!t)return'';if('function'==typeof a.default.getComputedStyle){var n=a.default.getComputedStyle(e);return n?n.getPropertyValue(t)||n[t]:''}return''}var C,N=a.default.navigator&&a.default.navigator.userAgent||'',x=/AppleWebKit\/([\d.]+)/i.exec(N);x&&parseFloat(x.pop()),/iPod/i.test(N),(C=N.match(/OS (\d+)_/i))&&C[1]&&C[1];var O=/Android/i.test(N);(()=>{var e=N.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;var t=e[1]&&parseFloat(e[1]),n=e[2]&&parseFloat(e[2]);t&&n&&parseFloat(e[1]+'.'+e[2])})(),/Firefox/i.test(N);var S,A=/Edg/i.test(N),M=!A&&(/Chrome/i.test(N)||/CriOS/i.test(N));(()=>{var e=N.match(/(Chrome|CriOS)\/(\d+)/);e&&e[2]&&parseFloat(e[2])})(),S=/MSIE\s(\d+)\.\d/.exec(N),!(S&&parseFloat(S[1]))&&/Trident\/7.0/i.test(N)&&/rv:11.0/.test(N);var P=/Safari/i.test(N)&&!M&&!O&&!A;/Windows/i.test(N);var W,_=Boolean(r.default===a.default.document&&('ontouchstart'in a.default||a.default.navigator.maxTouchPoints||a.default.DocumentTouch&&a.default.document instanceof a.default.DocumentTouch));/iPad/i.test(N)||P&&_&&/iPhone/i.test(N);function L(e){return'string'==typeof e&&Boolean(e.trim())}function R(e){if(e.indexOf(' ')>=0)throw new Error('class has illegal whitespace characters')}function j(e){return k(e)&&1===e.nodeType}function I(e){return(t,n)=>{if(!L(t))return r.default[e](null);L(n)&&(n=r.default.querySelector(n));var a=j(n)?n:r.default;return a[e]&&a[e](t)}}function F(e,t,n,a){void 0===e&&(e='div'),void 0===t&&(t={}),void 0===n&&(n={});var i=r.default.createElement(e);return Object.getOwnPropertyNames(t).forEach((e=>{var n=t[e];-1!==e.indexOf('aria-')||'role'===e||'type'===e?i.setAttribute(e,n):'style'===e&&'object'==typeof n?Object.getOwnPropertyNames(n).forEach((e=>{i.style[e]=n[e]})):'textContent'===e?function(e,t){void 0===e.textContent?e.innerText=t:e.textContent=t}(i,n):i[e]===n&&'tabIndex'!==e||(i[e]=n)})),Object.getOwnPropertyNames(n).forEach((e=>{i.setAttribute(e,n[e])})),a&&function(e,t){(function(e){'function'==typeof e&&(e=e());return(Array.isArray(e)?e:[e]).map((e=>('function'==typeof e&&(e=e()),j(e)||function(e){return k(e)&&3===e.nodeType}(e)?e:'string'==typeof e&&/\S/.test(e)?r.default.createTextNode(e):void 0))).filter((e=>e))})(t).forEach((t=>e.appendChild(t)))}(i,a),i}function z(e,t){return R(t),e.classList?e.classList.contains(t):(n=t,new RegExp('(^|\\s)'+n+'($|\\s)')).test(e.className);var n}function D(e,t){return e.classList?e.classList.add(t):z(e,t)||(e.className=(e.className+' '+t).trim()),e}function q(e,t){return e.classList?e.classList.remove(t):(R(t),e.className=e.className.split(/\s+/).filter((e=>e!==t)).join(' ')),e}function B(e,t){e.removeAttribute(t)}function $(e,t,n,r){void 0===r&&(r=function(e){return e.startsWith(n)?e:''});var a='';e.classList.forEach((e=>{0===a.length&&(a=r(e))})),a!==t&&(a.length>0&&q(e,a),D(e,t))}/iPhone/i.test(N),(W=Element.prototype).matches=W.matches||W.mozMatchesSelector||W.msMatchesSelector||W.oMatchesSelector||W.webkitMatchesSelector,W.closest=W.closest||function(e){return this?this.matches(e)?this:this.parentElement?this.parentElement.closest(e):null:null};var H=I('querySelector'),X=I('querySelectorAll');function U(e,t){var n='undefined'!=typeof Symbol&&e[Symbol.iterator]||e['@@iterator'];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if('string'==typeof e)return V(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);'Object'===n&&e.constructor&&(n=e.constructor.name);if('Map'===n||'Set'===n)return Array.from(e);if('Arguments'===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return V(e,t)}(e))||t&&e&&'number'==typeof e.length){n&&(e=n);var r=0;return()=>r>=e.length?{done:!0}:{done:!1,value:e[r++]}}throw new TypeError('Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.')}function V(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var G=(()=>{function e(){}e.removeOptionsPtoperty=function(e,t,n){if(void 0===n&&(n=Element),t[e]instanceof n==!1)throw Error('Invalid call. Property '+e+' is not valid');var r=t[e];return delete t[e],r};var t=e.prototype;return t.createEl=function(t,n,r,a){if(void 0===t&&(t='div'),void 0===n&&(n={}),void 0===r&&(r={}),void 0!==n.className){var i=new Set;('string'==typeof n.className?n.className.split(' '):n.className).forEach((e=>i.add(e)));for(var s,o='',l=U(i);!(s=l()).done;){var u=s.value;o+=' '+e.getClassName(u)}n.className=o.trim()}return F(t,n,r,a)},e._normalizePrefix=function(t){return t.replace(new RegExp('\\.','g'),'$&'+e.classPrefix)},t.$=function(t,n){return t=e._normalizePrefix(t),H(t,n)},t.$$=function(t,n){return t=e._normalizePrefix(t),X(t,n)},e})();d(G,{classPrefix:null,getClassName:function(e){return null===this.classPrefix||e.startsWith(this.classPrefix)?e:this.classPrefix+e}});var Y,K=(((e,t)=>{var n;n=e=>{e.version='1.2.0';var t=(()=>{for(var e=0,t=new Array(256),n=0;256!=n;++n)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=n)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[n]=e;return'undefined'!=typeof Int32Array?new Int32Array(t):t})();e.table=t,e.bstr=(e,n)=>{for(var r=-1^n,a=e.length-1,i=0;i<a;)r=(r=r>>>8^t[255&(r^e.charCodeAt(i++))])>>>8^t[255&(r^e.charCodeAt(i++))];return i===a&&(r=r>>>8^t[255&(r^e.charCodeAt(i))]),-1^r},e.buf=(e,n)=>{if(e.length>1e4)return((e,n)=>{for(var r=-1^n,a=e.length-7,i=0;i<a;)r=(r=(r=(r=(r=(r=(r=(r=r>>>8^t[255&(r^e[i++])])>>>8^t[255&(r^e[i++])])>>>8^t[255&(r^e[i++])])>>>8^t[255&(r^e[i++])])>>>8^t[255&(r^e[i++])])>>>8^t[255&(r^e[i++])])>>>8^t[255&(r^e[i++])])>>>8^t[255&(r^e[i++])];for(;i<a+7;)r=r>>>8^t[255&(r^e[i++])];return-1^r})(e,n);for(var r=-1^n,a=e.length-3,i=0;i<a;)r=(r=(r=(r=r>>>8^t[255&(r^e[i++])])>>>8^t[255&(r^e[i++])])>>>8^t[255&(r^e[i++])])>>>8^t[255&(r^e[i++])];for(;i<a+3;)r=r>>>8^t[255&(r^e[i++])];return-1^r},e.str=(e,n)=>{for(var r,a,i=-1^n,s=0,o=e.length;s<o;)(r=e.charCodeAt(s++))<128?i=i>>>8^t[255&(i^r)]:r<2048?i=(i=i>>>8^t[255&(i^(192|r>>6&31))])>>>8^t[255&(i^(128|63&r))]:r>=55296&&r<57344?(r=64+(1023&r),a=1023&e.charCodeAt(s++),i=(i=(i=(i=i>>>8^t[255&(i^(240|r>>8&7))])>>>8^t[255&(i^(128|r>>2&63))])>>>8^t[255&(i^(128|a>>6&15|(3&r)<<4))])>>>8^t[255&(i^(128|63&a))]):i=(i=(i=i>>>8^t[255&(i^(224|r>>12&15))])>>>8^t[255&(i^(128|r>>6&63))])>>>8^t[255&(i^(128|63&r))];return-1^i}},'undefined'==typeof DO_NOT_EXPORT_CRC?n(t):n({})})(Y={exports:{}},Y.exports),Y.exports);function J(e){return e&&'object'==typeof e&&!Array.isArray(e)}function Q(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(!n.length)return e;var a=n.shift();if(J(e)&&J(a))for(var i in a){var s,o;if(J(a[i]))e[i]||d(e,((s={})[i]={},s)),Q(e[i],a[i]);else d(e,((o={})[i]=a[i],o))}return Q.apply(void 0,[e].concat(n))}var Z={INIT:-1,WAIT:0,EXEC:1,DONE:2,ERROR:3,DELETED:99};function ee(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function te(e,t,n){return function(e,t){if(e!==t)throw new TypeError('Private static access of wrong provenance')}(e,t),function(e,t){if(void 0===e)throw new TypeError('attempted to '+t+' private static field before its declaration')}(n,'get'),function(e,t){if(t.get)return t.get.call(e);return t.value}(e,n)}function ne(e,t,n){if(!t.has(e))throw new TypeError('attempted to get private field on non-instance');return n}Z.SET_VISIBLE=[Z.WAIT,Z.EXEC,Z.ERROR,Z.DONE],Z.SET_COMPLETE=[Z.DONE,Z.ERROR,Z.DELETED],Z.is=(e,t)=>e.indexOf(t)>-1;var re=new WeakMap,ae=new WeakMap,ie=new WeakSet,se=function(e){function t(t,n){var r;return r=e.call(this)||this,ie.add(o(r)),re.set(o(r),{writable:!0,value:null}),ee(o(r),'id',void 0),ee(o(r),'common',!1),ee(o(r),'initiatorManager',void 0),ee(o(r),'progress',0),ee(o(r),'text',''),ee(o(r),'title',''),ee(o(r),'status',Z.INIT),ae.set(o(r),{writable:!0,value:null}),r.id=parseInt(t),f(o(r),re,n),r}u(t,e);var n=t.prototype;return n._renderChild=function(e){},n._buildCssClass=function(){return['task-item']},n.cssClassSwitch=function(){var e=ne(this,ie,oe).call(this);if('object'==typeof this.manager.options.theme){var n=this.manager.options.theme[this.status]||!1;n&&$(e,t.getClassName('theme-'+n),t.getClassName('theme'))}$(e,te(t,t,le).call(t)[this.status],t.getClassName('status'))},n.refresh=function(e,t){void 0===t&&(t=null),ne(this,ie,oe).call(this),t&&this._refreshElements(t,e)},n.getProgressTotal=function(e){void 0===e&&(e='progress');var t=0;return this.hasOwnProperty(e)&&'object'==typeof(t=this[e])&&t.length&&(t=Math.round(t.reduce(((e,t)=>e+t))/t.length,0)),t},n._refreshElements=function(e,t){var n=this,r=this.options.parts;Object.keys(e).forEach((a=>{var i=r[a],s='refreshBasicProperty';if('string'==typeof i){if(i.indexOf('.')>0){var o=i.split('.'),l=o[0],u=o[1];s=l+u[0].toUpperCase()+u.slice(1),i=u}var c=void 0!==n[i]?n[i]:null;c!==(void 0!==t[i]?t[i]:null)&&'function'==typeof n[s='_'+s]&&n[s].call(n,e[a],c,i)}}))},n._refreshBasicProperty=function(e,n,r){if(Array.isArray(n)){var a=t.getClassName('list-'+r),i=H('ul.'+a,e);null===i&&(i=this.createEl('ul',{className:a}),e.append(i)),n.forEach(((e,t)=>{var n=H('li:nth-child('+(t+1)+')',i);null===n?i.append(F('li',{},{},e)):n.innerText!==e&&(n.innerText=e)}))}else e.innerHTML=n},n.getTitle=function(){return''},n.toString=function(){return this.statusText+' '+this.getTitle()},s(t,[{key:'manager',get:function(){return h(this,re)}},{key:'element',get:function(){return h(this,ae)}},{key:'options',get:function(){return this.manager.options.taskOptions}},{key:'statusText',get:function(){return this.manager.options.statusText[this.status]||''}}]),t}(G);function oe(){if(h(this,ae))return h(this,ae);var e=f(this,ae,this.createEl('div',{className:'wrapper'},{'data-task-id':this.id})),t=this.createEl('div',{className:this._buildCssClass()});return this._renderChild(t),e.append(t),e}var le={writable:!0,value:function(){if(this._cssList)return this._cssList;for(var e in this._cssList={},Z)'number'==typeof Z[e]&&(this._cssList[Z[e]]=G.getClassName('status-'+e.toLowerCase()));return this._cssList}};function ue(e,t,n){return ce(e,t),function(e,t){if(void 0===e)throw new TypeError('attempted to '+t+' private static field before its declaration')}(n,'get'),function(e,t){if(t.get)return t.get.call(e);return t.value}(e,n)}function ce(e,t){if(e!==t)throw new TypeError('Private static access of wrong provenance')}function fe(e,t,n){if(!t.has(e))throw new TypeError('attempted to get private field on non-instance');return n}var he='__EMPTY__',de={method:'post',delayTime:1e3,params:{}},pe=new WeakMap,ve=new WeakMap,me=new WeakMap,ge=new WeakSet,ye=new WeakSet,we=new WeakSet,be=function(){function e(e){we.add(this),ye.add(this),ge.add(this),pe.set(this,{writable:!0,value:[]}),ve.set(this,{writable:!0,value:void 0}),me.set(this,{writable:!0,value:-1});var t,n=f(this,ve,Q({},de,e));n.params&&(k(t=n.params)&&'[object Object]'===b.call(t)&&t.constructor===Object)&&(n.params=Object.entries(n.params).map((e=>e[0]+'='+e[1])))}var t=e.prototype;return t.resolve=function(e,t){var n=this;if(!1===this.isRunning){var r=fe(this,we,Ce).call(this);f(this,me,0),r.forEach((t=>e(t))),fe(this,ge,Ee).call(this,0).catch((e=>{})).then((()=>{var e=h(n,me);return r.forEach((n=>t(n,e))),f(n,me,-1),e}))}},t.findTasks=function(e){return this.tasks.filter((t=>t.id===e))},e.factory=function(t){var n=t.options.resolver,r=K.str(n.url),a=ue(e,e,Ne),i=ue(e,e,xe),s=a[r]=a[r]instanceof e?a[r]:new e(n),o=fe(s,we,Ce).call(s);return-1===o.indexOf(t)&&(o.push(t),t.options.common&&i.push(t),t.ownerElement.addEventListener(Bt.Events.destroy,(e=>{var t=o.indexOf(e.manager);t>-1&&(i.forEach((e=>{e.getTasks().filter((e=>e.initiatorManager===o[t])).forEach((t=>{e.removeTask(t)}))})),o.splice(t,1)),(t=i.findIndex((t=>t===e.manager)))>-1&&i.splice(t,1)}))),s},s(e,[{key:'tasks',get:function(){var e=[];return h(this,pe).forEach((t=>{t.getTasks().forEach((t=>{!1===t.common&&e.push(t)}))})),e}},{key:'tasksId',get:function(){return this.tasks.map((e=>e.id)).filter(((e,t,n)=>n.indexOf(e===t)))}},{key:'options',get:function(){return h(this,ve)}},{key:'isRunning',get:function(){return h(this,me)>-1}}]),e}();function Ee(e){var t=this;return void 0===e&&(e=this.options.delayTime),fe(this,ye,Te).call(this,e).then((e=>{if(!1===e.ok)throw Error(e.status+' - '+e.statusText+'\' ');return e.json().then((e=>{var n,r,a;return e.length>0&&(e.forEach((e=>{t.findTasks(e.id).forEach((t=>{t.manager._updateTask(t,e)}))})),(n=be,r=be,a=ke,ce(n,r),a).call(be,e,t)),fe(t,ge,Ee).call(t)}))}))}function ke(e,t){ue(be,be,xe).forEach((n=>{e.forEach((e=>{var r,a=n.findTask(e.id);null===a&&!1===Z.is(Z.SET_COMPLETE,e.status)&&(e.common=!0,n.addTasks([e.id],!1),a=n.findTask(e.id),n._updateTask(a,e),a.initiatorManager=null==(r=t.tasks.find((t=>t.id===e.id)))?void 0:r.manager);a instanceof se&&a.common&&n._updateTask(a,e)}))}))}function Te(e){var t=this;return new Promise(((n,r)=>{var a=t.tasksId;0===a.length?r(he):setTimeout((()=>n(a)),e)})).then((e=>{f(t,me,+h(t,me)+1);var n=e.map((e=>'t[]='+e)),r=t.options.params;return Array.isArray(r)&&r.length>0&&(n=n.concat(r)),fetch(t.options.url,Q({},t.options,{method:'post',headers:{'Content-type':'application/x-www-form-urlencoded'},body:encodeURI(n.join('&'))}))}))}function Ce(e){return void 0===e&&(e=!1),!1===e?h(this,pe):h(this,pe).filter((e=>!0===e.options.common))}var Ne={writable:!0,value:[]},xe={writable:!0,value:[]},Oe={ready:'qmc:manager:ready',destroy:'qmc:manager:destroy',statusChange:'qmc:manager:statusChange',fetchStart:'qmc:resolver:start',fetchEnd:'qmc:resolver:end'};function Se(e){return(Se=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ae(){if('undefined'==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if('function'==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(()=>{}))),!0}catch(e){return!1}}function Me(e,t,n){return(Me=Ae()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&l(a,n.prototype),a}).apply(null,arguments)}function Pe(e){var t='function'==typeof Map?new Map:void 0;return(Pe=function(e){if(null===e||!function(e){return-1!==Function.toString.call(e).indexOf('[native code]')}(e))return e;if('function'!=typeof e)throw new TypeError('Super expression must either be null or a function');if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return Me(e,arguments,Se(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),l(n,e)})(e)}Oe.toString=function(){var e=[];return E(this,(t=>{e.push(t)})),e.join(' ')};var We,_e=new WeakMap,Le=function(e){function t(t,n,r){var a;return a=e.call(this,n,r)||this,_e.set(o(a),{writable:!0,value:null}),f(o(a),_e,t),a}return u(t,e),s(t,[{key:'manager',get:function(){return h(this,_e)}}]),t}(Pe(CustomEvent)),Re=3;a.default.WeakMap||(We=function(){function e(){this.vdata='vdata'+Math.floor(a.default.performance&&a.default.performance.now()||Date.now()),this.data={}}var t=e.prototype;return t.set=function(e,t){var n=e[this.vdata]||Re++;return e[this.vdata]||(e[this.vdata]=n),this.data[n]=t,this},t.get=function(e){var t=e[this.vdata];if(t)return this.data[t]},t.has=function(e){return e[this.vdata]in this.data},t.delete=function(e){var t=e[this.vdata];t&&(delete this.data[t],delete e[this.vdata])},e}());var je=a.default.WeakMap?new WeakMap:new We;var Ie=new WeakMap,Fe=new WeakMap,ze=new WeakMap,De=new WeakSet,qe=function(e){function t(){var n;n=e.call(this)||this,De.add(o(n)),ee(o(n),'label',''),ee(o(n),'className',t.getClassName('progress')),ee(o(n),'size',null),Ie.set(o(n),{writable:!0,value:[]}),ee(o(n),'barOptions',{}),Fe.set(o(n),{writable:!0,value:null}),ze.set(o(n),{writable:!0,value:null}),ee(o(n),'isShowGradient',!0);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return Q.apply(void 0,[o(n)].concat(a)),n}u(t,e);var n=t.prototype;return n.render=function(){var e=h(this,ze);if(e instanceof HTMLElement)return e;var n=this.className;return this.size&&(n+=' '+t.getClassName('size-'+this.size)),!1===this.isShowGradient&&(n+=' '+t.getClassName('no-gradient')),e=F('div',{className:n},{},F('div',{className:t.getClassName('progress-items')})),f(this,ze,e)},n.setProgress=function(e){var n=this,r=h(this,Ie),a=h(this,ze);e.length,(e='number'==typeof e?[e]:e).forEach(((e,i)=>{r[i]instanceof Xe?r[i].progress=e:(r[i]=new Xe(n.barOptions,{progress:e}),a.querySelector('.'+t.getClassName('progress-items')).append(F('div',{className:t.getClassName('progress-item')},{},r[i].render())))}));var i=t.getClassName('more-than-three');!1===z(a,i)&&e.length>3&&D(a,i)},n.setLabel=function(e){e&&(function(e,t,n){if(!t.has(e))throw new TypeError('attempted to get private field on non-instance');return n}(this,De,Be).call(this).innerHTML=e)},t}(G);function Be(){var e=h(this,Fe);return e instanceof Element||(f(this,Fe,e=F('span',{className:qe.getClassName('progress-label')},{})),h(this,ze).append(e)),e}ee(qe,'$classPrefix',null);var $e=new WeakMap,He=new WeakMap,Xe=function(){function e(){$e.set(this,{writable:!0,value:!1}),ee(this,'className','progress-bar'),He.set(this,{writable:!0,value:0}),ee(this,'labelText',''),ee(this,'min',0),ee(this,'max',100);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Q.apply(void 0,[this].concat(t))}return e.prototype.render=function(){var e=h(this,$e);if(e)return e;var t=[];return!1===this.labelText?t.push(F('span',{className:'sr-only',css:{width:0}},{},this.label)):t=this.label,f(this,$e,e=F('div',{className:qe.getClassName(this.className)},{role:'progressbar','aria-valuenow':this.progress,'aria-valuemin':this.min,'aria-valuemax':this.max},t)),e},s(e,[{key:'label',get:function(){var e=this.labelText?this.labelText:'';return this.progress+'% '+e}},{key:'progress',get:function(){return h(this,He)},set:function(e){f(this,He,e);var t=this.render();t.setAttribute('aria-valuenow',e),t.childNodes.length>0?t.childNodes[0].textContent=this.label:t.textContent=this.label,t.style.width=e+'%'}}]),e}();function Ue(e,t,n){if(!t.has(e))throw new TypeError('attempted to get private field on non-instance');return n}var Ve=new WeakMap,Ge=new WeakMap,Ye=new WeakMap,Ke=new WeakSet,Je=function(e){function t(t,n){var r;return void 0===t&&(t=!1),void 0===n&&(n=!1),r=e.call(this)||this,Ke.add(o(r)),Ve.set(o(r),{writable:!0,value:void 0}),Ge.set(o(r),{writable:!0,value:!1}),Ye.set(o(r),{writable:!0,value:!1}),f(o(r),Ge,t),f(o(r),Ye,n),r}return u(t,e),t.prototype.render=function(){var e=h(this,Ve);return e instanceof Element?e:f(this,Ve,this.createEl('span',{className:Ue(this,Ke,Qe).call(this)},{},F('span',{},{},['s1','s2','s3'].map((e=>F('span',{className:e}))))))},s(t,[{key:'icon',set:function(e){if(e){var t=h(this,Ge);if(t!==e){var n=h(this,Ve);t&&q(n,t),D(n,e),f(this,Ge,e)}}}},{key:'size',set:function(e){if(e){e=t.getClassName('size-'+e);var n=h(this,Ye);if(n!==e){var r=h(this,Ve);n&&q(r,n),D(r,e),f(this,Ye,e)}}}},{key:'color',set:function(e){X('span[class^=s]',h(this,Ve)).forEach((t=>{t.style.backgroundColor=e}))}}]),t}(G);function Qe(){var e='icon-t',t=[];return h(this,Ge)&&(e+=' '+h(this,Ge)),t.push(e),h(this,Ye)&&t.push('size-'+h(this,Ye)),t}function Ze(e,t,n){return function(e,t){if(e!==t)throw new TypeError('Private static access of wrong provenance')}(e,t),n}var et={tagName:'button',handler:null,handlerTimoutDelay:500,label:!1,hiddenLabel:'',disabled:!1,size:null,iconName:null,iconHoverName:null,iconSize:null,animatedClick:!0,data:{}},tt=new WeakMap,nt=new WeakMap,rt=new WeakMap,at=new WeakSet,it=function(e){function t(t){var n;return n=e.call(this)||this,at.add(o(n)),tt.set(o(n),{writable:!0,value:void 0}),nt.set(o(n),{writable:!0,value:et}),rt.set(o(n),{writable:!0,value:null}),t&&'object'==typeof t&&f(o(n),nt,Q({},et,t)),n}return u(t,e),t.prototype.render=function(){var e=h(this,tt);if(e instanceof Element)return e;var n=this.options,r=[];if(n.iconName){var a=this.icon;r.push(a.render()),a.icon=n.iconName,a.size=n.iconSize}if(n.label&&r.push(F('p',{},{},n.label)),n.hiddenLabel&&r.push(this.createEl('p',{className:'button-hidden'},{},n.hiddenLabel)),n.animatedClick){var i=F('p',{className:'drop'});i.addEventListener('animationend',(function(){q(this,'animate')})),r.push(i)}return e=f(this,tt,this.createEl(n.tagName,{className:Ze(t,t,st).call(t,n)},{},r)),this.disabled=n.disabled,function(e,t,n){if(!t.has(e))throw new TypeError('attempted to get private field on non-instance');return n}(this,at,ot).call(this,e,n),e},s(t,[{key:'disabled',set:function(e){var t=this.options;e!==t.disabled&&('button'===t.tagName.toLowerCase()?h(this,tt).disabled=e:function(e,t,n){var r=z(e,t);if('function'==typeof n&&(n=n(e,t)),'boolean'!=typeof n&&(n=!r),n!==r)n?D(e,t):q(e,t)}(h(this,tt),'disabled'),t.disabled=e)}},{key:'options',get:function(){return h(this,nt)}},{key:'element',get:function(){return this.render()}},{key:'icon',get:function(){var e=h(this,rt);return e instanceof Je?e:f(this,rt,new Je)}}]),t}(G);function st(e){var t=['button'];return e.size&&t.push('size-'+e.size),e.hiddenLabel&&t.push('has-hidden'),t}function ot(e,t){var n=this;e.addEventListener('click',(n=>{if(t.disabled)return n.stopImmediatePropagation(),!1;t.animatedClick&&Ze(it,it,lt).call(it,e)})),'function'==typeof t.handler&&(t.handlerTimoutDelay>0?e.addEventListener('click',(e=>{setTimeout((()=>t.handler.call(n,e)),t.handlerTimoutDelay)})):e.addEventListener('click',t.handler.bind(this))),t.iconHoverName&&(e.addEventListener('mouseenter',(()=>{!1===t.disabled&&(n.icon.icon=t.iconHoverName)})),e.addEventListener('mouseleave',(()=>{n.icon.icon=t.iconName})))}function lt(e){var t=H('.drop',e);if(t){var n=function(e){if(e&&e.getBoundingClientRect&&e.parentNode){var t=e.getBoundingClientRect(),n={};return['bottom','height','left','right','top','width'].forEach((e=>{void 0!==t[e]&&(n[e]=t[e])})),n.height||(n.height=parseFloat(T(e,'height'))),n.width||(n.width=parseFloat(T(e,'width'))),n}}(e),r=event.pageX-n.width/2-n.left-window.scrollX,a=event.pageY-n.height/2-n.top-window.scrollY;t.style.top=a+'px',t.style.left=r+'px',D(t,'animate')}}function ut(e,t,n){return function(e,t){if(e!==t)throw new TypeError('Private static access of wrong provenance')}(e,t),n}it.Defaults=et;var ct={buttons:[],arrange:!1,scaled:!1,selectable:!1,selectIcon:null},ft=new WeakMap,ht=new WeakMap,dt=new WeakSet,pt=function(e){function t(t){var n;n=e.call(this)||this,dt.add(o(n)),ee(o(n),'buttons',null),ft.set(o(n),{writable:!0,value:ct}),ht.set(o(n),{writable:!0,value:void 0});var r=G.removeOptionsPtoperty('buttons',t,Array);return f(o(n),ft,Q({},ct,t)),n.buttons=r.map((e=>new it(e))),n}return u(t,e),t.prototype.render=function(){var e=h(this,ht);return e instanceof Element||(f(this,ht,e=this.createEl('div',{className:ut(t,t,vt).call(t,this.options)},{},this.buttons.map((e=>e.render())))),this.options.selectable&&function(e,t,n){if(!t.has(e))throw new TypeError('attempted to get private field on non-instance');return n}(this,dt,mt).call(this,e)),e},s(t,[{key:'options',get:function(){return h(this,ft)}},{key:'arrange',set:function(e){var n=t.getClassName('arrange'),r=h(this,ht),a=h(this,ft);r&&(e?!1===z(r,n)&&D(r,n):q(r,n)),a.arrange=e}},{key:'selected',set:function(e){var n=t.getClassName('selected'),r=this.options;'number'==typeof e&&(e=this.buttons[e]),e instanceof it&&(this.buttons.forEach((e=>{B(e.element,'data-group-selected'),q(e.element,n)})),D(e.element,n),r.selectIcon&&(e.icon.icon=r.selectIcon,e.options.iconName=r.selectIcon))}}]),t}(G);function vt(e){var t=['button-group'];return e.arrange&&t.push('arrange'),e.scaled&&t.push('scaled'),t}function mt(e){var t=this;e.addEventListener('click',(e=>{var n=e.target.closest('.'+pt.getClassName('button'));t.selected=t.buttons.find((e=>e.element===n))})),e.addEventListener('mouseenter',(e=>{t.$$('.button.selected',e.target).forEach((e=>{!function(e,t,n){e.setAttribute(t,n)}(e,'data-group-selected',!0),q(e,pt.getClassName('selected'))}))})),e.addEventListener('mouseleave',(e=>{t.$$('.button[data-group-selected]',e.target).forEach((e=>{B(e,'data-group-selected'),D(e,pt.getClassName('selected'))}))}))}var gt=new WeakMap,yt=new WeakMap,wt=new WeakMap,bt=new WeakMap,Et=new WeakMap,kt=function(e){function t(t,n,r){var a;return a=e.call(this)||this,gt.set(o(a),{writable:!0,value:[]}),ee(o(a),'map',{icons:[],actions:[]}),yt.set(o(a),{writable:!0,value:void 0}),wt.set(o(a),{writable:!0,value:null}),bt.set(o(a),{writable:!0,value:null}),Et.set(o(a),{writable:!0,value:null}),f(o(a),yt,t),a.map.icons=n,a.map.actions=r,f(o(a),wt,new Je('none','big')),f(o(a),bt,a.createEl('span',{className:'status-text'})),r.forEach((e=>{Q(e,{data:{task:t}})})),a}u(t,e);var n=t.prototype;return n.render=function(){var e=h(this,gt);return e.length>0||(e.push(h(this,wt).render()),e.push(h(this,bt)),this.map.actions.length>0&&(f(this,Et,new pt({buttons:this.map.actions,arrange:!1,scaled:!0})),e.push(h(this,Et).render()))),e},n.refresh=function(e){h(this,bt).innerHTML=h(this,yt).statusText,h(this,wt).icon=this.map.icons[e];var t=h(this,Et);t&&t.buttons.forEach((t=>{var n,r=null==(n=t.options)?void 0:n.enabledWithStatus;if('function'==typeof r&&(r=r.call(t,e)),Array.isArray(r)){if(0===t.options.enabledWithStatus.length)return;t.disabled=-1===t.options.enabledWithStatus.indexOf(e)}else'boolean'==typeof r&&(t.disabled=r)}))},t}(G);function Tt(e,t,n){return function(e,t){if(e!==t)throw new TypeError('Private static access of wrong provenance')}(e,t),n}var Ct={iconPlacement:'default',parts:{status:'refresh.status',title:'title',text:'text',error:'errors','progress-wrapper':'refresh.progress'},progress:{label:'',size:'',barOptions:{labelText:!1}},actions:[]},Nt={};Nt[Z.WAIT]='clock',Nt[Z.EXEC]='play',Nt[Z.ERROR]='warning',Nt[Z.DONE]='checked';var xt=new WeakMap,Ot=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,xt.set(o(t),{writable:!0,value:{}}),t}u(t,e);var n=t.prototype;return n._renderChild=function(e){var n=this,r=h(this,xt),a=this.options,i=e.appendChild(this.createEl('div',{className:'detail'})),s=e.appendChild(this.createEl('div',{className:'status-wrapper'}));Object.keys(a.parts).forEach((e=>{var o,l=i,u=null;if('progress-wrapper'===e?a.progress?u=new qe(a.progress):delete a['progress-wrapper']:'status'===e&&(l=s,u=new kt(n,Nt,a.actions)),r[e]=l.appendChild(n.createEl('div',{className:e},{})),u&&'function'==typeof(null==(o=u)?void 0:o.render)){var c=u.render();c instanceof Element&&(c=[c]),c.forEach((t=>r[e].append(t))),Tt(t,t,St).call(t,r[e],u)}}))},n.refresh=function(t){e.prototype.refresh.call(this,t,h(this,xt))},n._buildCssClass=function(){var t=e.prototype._buildCssClass.call(this);return this.options.iconPlacement!==Ct.iconPlacement&&t.push('task-item-'+this.options.iconPlacement),t},n._refreshProgress=function(e,n){var r=Tt(t,t,At).call(t,e);r instanceof qe&&(r.setLabel(this.getProgressTotal()+'%'),r.setProgress(n))},n._refreshStatus=function(e,n){Tt(t,t,At).call(t,e).refresh(n)},n.getTitle=function(){var e,t=this.options.parts.title;return t&&null!=(e=this[t])?e:''},t}(se);function St(e,t){je.has(e)||je.set(e,{}),je.get(e).componet=t}function At(e){if(je.has(e)){var t=je.get(e);if(void 0!==t.componet)return t.componet}return null}Ot.Defualts=Ct;var Mt={linear:function(e){return e},quad:function(e){return Math.pow(e,2)},circ:function(e){return 1-Math.sin(Math.acos(e))},back:function(e,t){return void 0===e&&(e=1.5),Math.pow(t,2)*((e+1)*t-e)}},Pt={fadeOut:function(e){this.style.opacity=1-Math.round(100*e)/100},fadeIn:function(e){'none'===this.style.display&&(this.style.display=null),this.style.opacity=Math.round(100*e)/100}};function Wt(e,t){void 0===t&&(t={name:'fadeOut',timing:Mt.linear,duration:500,delay:0});var n=d({},t);if('function'==typeof n.draw)n.draw.bind(e);else{if('string'!=typeof n.name||'function'!=typeof Pt[n.name])throw new Error('Unknown animation ');n.draw=Pt[n.name].bind(e)}return'number'!=typeof n.delay&&(n.delay=0),n.timing='string'==typeof n.timing&&'function'==typeof Mt[n.timing]?Mt[n.timing]:Mt.linear,new Promise((t=>{setTimeout((()=>{return a=()=>{t(e)},i=(r=n).timing,s=r.draw,o=r.duration,l=performance.now(),void requestAnimationFrame((function e(t){var n=(t-l)/o;n>1&&(n=1);var r=i(n);s(r),n<1?requestAnimationFrame(e):a&&a()}));var r,a,i,s,o,l}),n.delay)}))}function _t(e,t,n){if(!t.has(e))throw new TypeError('attempted to get private field on non-instance');return n}var Lt={common:!1,title:'<h3>Backgrounds tasks</h3>',theme:{'-1':'default'},renderOnEmpty:!0,taskClass:Ot,emptyText:'Tasks not provided yet',taskOptions:{},tasks:[],statusText:{},hideAnimation:{name:'fadeOut',duration:1e3,timing:'linear',delay:0},showAnimation:{name:'fadeIn',duration:1e3,timing:'linear',delay:0},tasksAnimation:{hide:{},show:{}},resolver:{url:'queue-reader'}};Lt.tasksAnimation.hide[Z.DONE]=Q({},Lt.hideAnimation,{delay:5e3}),Lt.tasksAnimation.hide[Z.ERROR]=Q({},Lt.hideAnimation,{delay:2e4}),Lt.tasksAnimation.show[Z.EXEC]=Q({},Lt.showAnimation,{duration:500}),Lt.tasksAnimation.show[Z.WAIT]=Q({},Lt.showAnimation,{duration:500}),Lt.tasksAnimation.hide[Z.ERROR]=!1,Lt.statusText[Z.DONE]='Complete',Lt.statusText[Z.ERROR]='Complete with errors',Lt.statusText[Z.EXEC]='Processing',Lt.statusText[Z.WAIT]='Awaiting';var Rt=new WeakMap,jt=new WeakMap,It=new WeakMap,Ft=new WeakMap,zt=new WeakSet,Dt=new WeakSet,qt=new WeakSet,Bt=function(e){function t(n){var r;r=e.call(this)||this,qt.add(o(r)),Dt.add(o(r)),zt.add(o(r)),Rt.set(o(r),{writable:!0,value:null}),jt.set(o(r),{writable:!0,value:{owner:null,wrapper:null,wrapperTasks:null,emptyText:null}}),It.set(o(r),{writable:!0,value:[]}),Ft.set(o(r),{writable:!0,value:{}}),h(o(r),jt).owner=G.removeOptionsPtoperty('element',n);var a=Q({},t.Defaults,n);return f(o(r),Ft,Q({},{taskOptions:a.taskClass.Defualts},a)),f(o(r),Rt,be.factory(o(r))),r.render(),n.tasks&&void 0!==n.tasks.length&&r.addTasks(n.tasks),setTimeout((()=>{0===r.getTasks().length&&_t(o(r),zt,$t).call(o(r),'show')}),200),r.trigger(Oe.ready,{bubbles:!0}),r}u(t,e);var n=t.prototype;return n.destroy=function(){this.trigger(Oe.destroy,{bubbles:!0}),f(this,It,[]),this.ownerElement.remove()},n.trigger=function(e,t,n){if(void 0===t&&(t={}),'object'==typeof n){t.detail={};for(var r=0,a=Object.entries(n);r<a.length;r++){var i=a[r],s=i[0],o=i[1];t.detail[s]=o}}return this.ownerElement.dispatchEvent(new Le(this,e,t))},n.render=function(){var e=this.getTasks(Z.SET_VISIBLE);if(0===e.length&&!1===this.options.renderOnEmpty)return!1;var n=h(this,jt);if(null===n.wrapper){var r=this.options;n.wrapper=n.owner.appendChild(this.createEl('div',{className:'wrapper'})),0===n.wrapper.childNodes.length&&(r.title&&this.options.title.length>0&&n.wrapper.appendChild(this.createEl('div',{innerHTML:this.options.title,className:'title'})),n.wrapperTasks=n.wrapper.appendChild(this.createEl('div',{className:'tasks'})),r.emptyText.length>0&&(n.emptyText=n.wrapper.appendChild(n.emptyText=this.createEl('div',{className:'empty-wrapper',style:{display:'none'}},{},[this.createEl('span',{className:'empty-text',textContent:r.emptyText})])))),'string'==typeof r.theme&&$(n.wrapper,t.getClassName('theme-'+r.theme),t.getClassName('theme'))}return e.forEach((e=>e.refresh())),!0},n.addTasks=function(e,t){var n=this;void 0===t&&(t=!0),e&&e.length>0&&(f(this,It,h(this,It).concat(e)),_t(this,zt,$t).call(this,'hide').then((()=>{t&&n.resolver.resolve((e=>{e.getTasks().length>0&&e.trigger(Oe.fetchStart,{bubbles:!0})}),((e,t)=>{e.trigger(Oe.fetchEnd,{bubbles:!0},{requests:t})}))})))},n._updateTask=function(e,t){if(e.progress!==t.progress||e.status!==t.status||e.text!==t.text||e.title!==t.title){var n=e.status!==t.status,r=Q({},e);if((e=Q(e,t)).refresh(r),n){if(e.cssClassSwitch(),Z.is([Z.EXEC],e.status),this.trigger(Oe.statusChange,{bubbles:!0},{task:e,oldStatus:r.status}),Z.is(Z.SET_VISIBLE,e.status)&&null===e.element.parentNode){var a=e.element;a.style.display='none',this.wrapperTasksElement.append(a),Wt(a,_t(this,Dt,Ht).call(this,e,'show'))}Z.is(Z.SET_COMPLETE,e.status)&&e.element.parentNode instanceof Element&&this.removeTask(e)}}},n.removeTask=function(e,t){var n=this;void 0===t&&(t=null);var r=this.getTasks();if('number'==typeof e&&(e=r.find((t=>t.id===e))),e instanceof se){var a=this.getTasks().findIndex((t=>t.id===e.id));if(a>-1)return h(this,It).splice(a,1),_t(this,qt,Xt).call(this,e.element,_t(this,Dt,Ht).call(this,e)).then((e=>{t&&t(e),0===h(n,It).length&&_t(n,zt,$t).call(n,'show')})),!0}return!1},n.getTasks=function(e){var t=this,n=h(this,It),r=this.options.taskClass;return n.forEach(((e,a)=>{e instanceof se||('object'==typeof e?n[a]=Q(new r(null,t),e):Number.parseInt(e)>0&&(n[a]=new r(e,t)))})),e?('number'==typeof e&&(e=[e]),n.filter((t=>{if(e.indexOf(t.status)>-1)return t}))):n},n.findTask=function(e){var t=this.getTasks().find((t=>t.id===e));return t instanceof se?t:null},s(t,[{key:'options',get:function(){return h(this,Ft)}},{key:'ownerElement',get:function(){return h(this,jt).owner}},{key:'wrapperElement',get:function(){return h(this,jt).wrapper}},{key:'wrapperTasksElement',get:function(){return h(this,jt).wrapperTasks}},{key:'resolver',get:function(){return h(this,Rt)}}]),t}(G);function $t(e){var t=h(this,jt).emptyText,n=function(e){var t;return!1!==j(e)&&0!==(''!==(null==(t=e.style)?void 0:t.opacity)?parseFloat(e.style.opacity):1)&&'hidden'!==T(e,'visibility')&&!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)}(t);if(j(t)){if(n&&'hide'===e||!1===n&&'show'===e)return Wt(t,this.options[e+'Animation']);t.style.display='show'===e?'block':'none'}return Promise.resolve(t)}function Ht(e,t){void 0===t&&(t='hide');var n=this.options;return void 0!==n.tasksAnimation[t][e.status]?n.tasksAnimation[t][e.status]:n[t+'Animation']}function Xt(e,t){return void 0===t&&(t=this.options.hideAnimation),!1!==t?Wt(e,t).then((e=>(e.remove(),e))):Promise.resolve(!1)}G.classPrefix='qmc-',Bt.TaskAbstract=se,Bt.Button=it,Bt.ButtonsGroup=pt,Bt.Icon=Je,Bt.Defaults=Lt,Bt.Events=Oe,Bt.Statuses=Z}(document,window);
