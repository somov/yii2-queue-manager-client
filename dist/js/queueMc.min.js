/*!
 * @license
 * yii2-queue-manager-client 0.1.0 <https://github.com/somov/yii2-queue-manager-client#readme>
 * Copyright: somov.nn@gmail.com
 * Licensed under MIT
 */
!function(e,t){function n(e){return e&&'object'==typeof e&&'default'in e?e:{default:e}}var r=n(e),a=n(t);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,'value'in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function s(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function o(e){if(void 0===e)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return e}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,l(e,t)}function c(e,t,n){if(!t.has(e))throw new TypeError('attempted to '+n+' private field on non-instance');return t.get(e)}function f(e,t,n){return function(e,t,n){if(t.set)t.set.call(e,n);else{if(!t.writable)throw new TypeError('attempted to set read only private field');t.value=n}}(e,c(e,t,'set'),n),n}function h(e,t){return function(e,t){return t.get?t.get.call(e):t.value}(e,c(e,t,'get'))}function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}for(var p,v={prefixed:!0},m=[['requestFullscreen','exitFullscreen','fullscreenElement','fullscreenEnabled','fullscreenchange','fullscreenerror','fullscreen'],['webkitRequestFullscreen','webkitExitFullscreen','webkitFullscreenElement','webkitFullscreenEnabled','webkitfullscreenchange','webkitfullscreenerror','-webkit-full-screen'],['mozRequestFullScreen','mozCancelFullScreen','mozFullScreenElement','mozFullScreenEnabled','mozfullscreenchange','mozfullscreenerror','-moz-full-screen'],['msRequestFullscreen','msExitFullscreen','msFullscreenElement','msFullscreenEnabled','MSFullscreenChange','MSFullscreenError','-ms-fullscreen']],g=m[0],w=0;w<m.length;w++)if(m[w][1]in r.default){p=m[w];break}if(p){for(var y=0;y<p.length;y++)v[g[y]]=p[y];v.prefixed=p[0]!==g[0]}function b(e,t){(e=>E(e)?Object.keys(e):[])(e).forEach((n=>t(e[n],n)))}function E(e){return!!e&&'object'==typeof e}function k(e,t){if(!e||!t)return'';if('function'==typeof a.default.getComputedStyle){var n=a.default.getComputedStyle(e);return n?n.getPropertyValue(t)||n[t]:''}return''}var T,C=a.default.navigator&&a.default.navigator.userAgent||'',N=/AppleWebKit\/([\d.]+)/i.exec(C);N&&parseFloat(N.pop()),/iPod/i.test(C),(T=C.match(/OS (\d+)_/i))&&T[1]&&T[1];var x=/Android/i.test(C);(()=>{var e=C.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;var t=e[1]&&parseFloat(e[1]),n=e[2]&&parseFloat(e[2]);t&&n&&parseFloat(e[1]+'.'+e[2])})(),/Firefox/i.test(C);var O,S=/Edg/i.test(C),A=!S&&(/Chrome/i.test(C)||/CriOS/i.test(C));(()=>{var e=C.match(/(Chrome|CriOS)\/(\d+)/);e&&e[2]&&parseFloat(e[2])})(),O=/MSIE\s(\d+)\.\d/.exec(C),!(O&&parseFloat(O[1]))&&/Trident\/7.0/i.test(C)&&/rv:11.0/.test(C);var M=/Safari/i.test(C)&&!A&&!x&&!S;/Windows/i.test(C);var P,W=Boolean(r.default===a.default.document&&('ontouchstart'in a.default||a.default.navigator.maxTouchPoints||a.default.DocumentTouch&&a.default.document instanceof a.default.DocumentTouch));/iPad/i.test(C)||M&&W&&/iPhone/i.test(C);function _(e){return'string'==typeof e&&Boolean(e.trim())}function L(e){if(e.indexOf(' ')>=0)throw new Error('class has illegal whitespace characters')}function R(e){return E(e)&&1===e.nodeType}function I(e){return(t,n)=>{if(!_(t))return r.default[e](null);_(n)&&(n=r.default.querySelector(n));var a=R(n)?n:r.default;return a[e]&&a[e](t)}}function j(e,t,n,a){void 0===e&&(e='div'),void 0===t&&(t={}),void 0===n&&(n={});var i=r.default.createElement(e);return Object.getOwnPropertyNames(t).forEach((e=>{var n=t[e];-1!==e.indexOf('aria-')||'role'===e||'type'===e?i.setAttribute(e,n):'style'===e&&'object'==typeof n?Object.getOwnPropertyNames(n).forEach((e=>{i.style[e]=n[e]})):'textContent'===e?function(e,t){void 0===e.textContent?e.innerText=t:e.textContent=t}(i,n):i[e]===n&&'tabIndex'!==e||(i[e]=n)})),Object.getOwnPropertyNames(n).forEach((e=>{i.setAttribute(e,n[e])})),a&&function(e,t){(function(e){'function'==typeof e&&(e=e());return(Array.isArray(e)?e:[e]).map((e=>('function'==typeof e&&(e=e()),R(e)||function(e){return E(e)&&3===e.nodeType}(e)?e:'string'==typeof e&&/\S/.test(e)?r.default.createTextNode(e):void 0))).filter((e=>e))})(t).forEach((t=>e.appendChild(t)))}(i,a),i}function F(e,t){return L(t),e.classList?e.classList.contains(t):(n=t,new RegExp('(^|\\s)'+n+'($|\\s)')).test(e.className);var n}function z(e,t){return e.classList?e.classList.add(t):F(e,t)||(e.className=(e.className+' '+t).trim()),e}function D(e,t){return e.classList?e.classList.remove(t):(L(t),e.className=e.className.split(/\s+/).filter((e=>e!==t)).join(' ')),e}function q(e,t){e.removeAttribute(t)}function B(e,t,n,r){void 0===r&&(r=function(e){return e.startsWith(n)?e:''});var a='';e.classList.forEach((e=>{0===a.length&&(a=r(e))})),a!==t&&(a.length>0&&D(e,a),z(e,t))}/iPhone/i.test(C),(P=Element.prototype).matches=P.matches||P.mozMatchesSelector||P.msMatchesSelector||P.oMatchesSelector||P.webkitMatchesSelector,P.closest=P.closest||function(e){return this?this.matches(e)?this:this.parentElement?this.parentElement.closest(e):null:null};var $=I('querySelector'),H=I('querySelectorAll');function X(e,t){var n='undefined'!=typeof Symbol&&e[Symbol.iterator]||e['@@iterator'];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(!e)return;if('string'==typeof e)return U(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);'Object'===n&&e.constructor&&(n=e.constructor.name);if('Map'===n||'Set'===n)return Array.from(e);if('Arguments'===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return U(e,t)}(e))||t&&e&&'number'==typeof e.length){n&&(e=n);var r=0;return()=>r>=e.length?{done:!0}:{done:!1,value:e[r++]}}throw new TypeError('Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.')}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var V=(()=>{function e(){}e.removeOptionsPtoperty=function(e,t,n){if(void 0===n&&(n=Element),t[e]instanceof n==!1)throw Error('Invalid call. Property '+e+' is not valid');var r=t[e];return delete t[e],r};var t=e.prototype;return t.createEl=function(t,n,r,a){if(void 0===t&&(t='div'),void 0===n&&(n={}),void 0===r&&(r={}),void 0!==n.className){var i=new Set;('string'==typeof n.className?n.className.split(' '):n.className).forEach((e=>i.add(e)));for(var s,o='',l=X(i);!(s=l()).done;){var u=s.value;o+=' '+e.getClassName(u)}n.className=o.trim()}return j(t,n,r,a)},e._normalizePrefix=function(t){return t.replace(new RegExp('\\.','g'),'$&'+e.classPrefix)},t.$=function(t,n){return t=e._normalizePrefix(t),$(t,n)},t.$$=function(t,n){return t=e._normalizePrefix(t),H(t,n)},e})();d(V,{classPrefix:null,getClassName:function(e){return null===this.classPrefix||e.startsWith(this.classPrefix)?e:this.classPrefix+e}});var G,Y=(((e,t)=>{var n;n=e=>{e.version='1.2.0';var t=(()=>{for(var e=0,t=new Array(256),n=0;256!=n;++n)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=n)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[n]=e;return'undefined'!=typeof Int32Array?new Int32Array(t):t})();e.table=t,e.bstr=(e,n)=>{for(var r=-1^n,a=e.length-1,i=0;i<a;)r=(r=r>>>8^t[255&(r^e.charCodeAt(i++))])>>>8^t[255&(r^e.charCodeAt(i++))];return i===a&&(r=r>>>8^t[255&(r^e.charCodeAt(i))]),-1^r},e.buf=(e,n)=>{if(e.length>1e4)return((e,n)=>{for(var r=-1^n,a=e.length-7,i=0;i<a;)r=(r=(r=(r=(r=(r=(r=(r=r>>>8^t[255&(r^e[i++])])>>>8^t[255&(r^e[i++])])>>>8^t[255&(r^e[i++])])>>>8^t[255&(r^e[i++])])>>>8^t[255&(r^e[i++])])>>>8^t[255&(r^e[i++])])>>>8^t[255&(r^e[i++])])>>>8^t[255&(r^e[i++])];for(;i<a+7;)r=r>>>8^t[255&(r^e[i++])];return-1^r})(e,n);for(var r=-1^n,a=e.length-3,i=0;i<a;)r=(r=(r=(r=r>>>8^t[255&(r^e[i++])])>>>8^t[255&(r^e[i++])])>>>8^t[255&(r^e[i++])])>>>8^t[255&(r^e[i++])];for(;i<a+3;)r=r>>>8^t[255&(r^e[i++])];return-1^r},e.str=(e,n)=>{for(var r,a,i=-1^n,s=0,o=e.length;s<o;)(r=e.charCodeAt(s++))<128?i=i>>>8^t[255&(i^r)]:r<2048?i=(i=i>>>8^t[255&(i^(192|r>>6&31))])>>>8^t[255&(i^(128|63&r))]:r>=55296&&r<57344?(r=64+(1023&r),a=1023&e.charCodeAt(s++),i=(i=(i=(i=i>>>8^t[255&(i^(240|r>>8&7))])>>>8^t[255&(i^(128|r>>2&63))])>>>8^t[255&(i^(128|a>>6&15|(3&r)<<4))])>>>8^t[255&(i^(128|63&a))]):i=(i=(i=i>>>8^t[255&(i^(224|r>>12&15))])>>>8^t[255&(i^(128|r>>6&63))])>>>8^t[255&(i^(128|63&r))];return-1^i}},'undefined'==typeof DO_NOT_EXPORT_CRC?n(t):n({})})(G={exports:{}},G.exports),G.exports);function K(e){return e&&'object'==typeof e&&!Array.isArray(e)}function J(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(!n.length)return e;var a=n.shift();if(K(e)&&K(a))for(var i in a){var s,o;if(K(a[i]))e[i]||d(e,((s={})[i]={},s)),J(e[i],a[i]);else d(e,((o={})[i]=a[i],o))}return J.apply(void 0,[e].concat(n))}function Q(e,t,n){return Z(e,t),function(e,t){if(void 0===e)throw new TypeError('attempted to '+t+' private static field before its declaration')}(n,'get'),function(e,t){if(t.get)return t.get.call(e);return t.value}(e,n)}function Z(e,t){if(e!==t)throw new TypeError('Private static access of wrong provenance')}function ee(e,t,n){if(!t.has(e))throw new TypeError('attempted to get private field on non-instance');return n}var te='__EMPTY__',ne={method:'post',delayTime:1e3},re=new WeakMap,ae=new WeakMap,ie=new WeakMap,se=new WeakSet,oe=new WeakSet,le=new WeakSet,ue=function(){function e(e){le.add(this),oe.add(this),se.add(this),re.set(this,{writable:!0,value:[]}),ae.set(this,{writable:!0,value:void 0}),ie.set(this,{writable:!0,value:-1}),f(this,ae,J({},ne,e))}var t=e.prototype;return t.resolve=function(e,t){var n=this;if(!1===this.isRunning){var r=ee(this,le,de).call(this);f(this,ie,0),r.forEach((t=>e(t))),ee(this,se,ce).call(this,0).catch((e=>{})).then((()=>{var e=h(n,ie);return r.forEach((n=>t(n,e))),f(n,ie,-1),e}))}},t.findTask=function(e){var t=this.tasks.find((t=>t.id===e));return t||!1},e.factory=function(t){var n=t.options.resolver,r=Y.str(n.url),a=Q(e,e,pe),i=Q(e,e,ve),s=a[r]=a[r]instanceof e?a[r]:new e(n),o=ee(s,le,de).call(s);return-1===o.indexOf(t)&&(o.push(t),t.options.common&&i.push(t),t.ownerElement.addEventListener(qt.Events.destroy,(e=>{var t=o.indexOf(e.manager);t>-1&&(i.forEach((e=>{e.getTasks().filter((e=>e.initiatorManager===o[t])).forEach((t=>{e.removeTask(t)}))})),o.splice(t,1)),(t=i.findIndex((t=>t===e.manager)))>-1&&i.splice(t,1)}))),s},s(e,[{key:'tasks',get:function(){var e=[];return h(this,re).forEach((t=>{t.getTasks().forEach((t=>{!1===t.common&&e.push(t)}))})),e}},{key:'tasksId',get:function(){return this.tasks.map((e=>e.id)).filter(((e,t,n)=>n.indexOf(e===t)))}},{key:'options',get:function(){return h(this,ae)}},{key:'isRunning',get:function(){return h(this,ie)>-1}}]),e}();function ce(e){var t=this;return void 0===e&&(e=this.options.delayTime),ee(this,oe,he).call(this,e).then((e=>{if(!1===e.ok)throw Error(e.status+' - '+e.statusText+'\' ');return e.json().then((e=>{var n,r,a;return e.length>0&&(e.forEach((e=>{var n=t.findTask(e.id);n&&n.manager._updateTask(n,e)})),(n=ue,r=ue,a=fe,Z(n,r),a).call(ue,e,t)),ee(t,se,ce).call(t)}))}))}function fe(e,t){Q(ue,ue,ve).forEach((n=>{e.forEach((e=>{var r,a=n.findTask(e.id);null===a&&(e.common=!0,e.title='',n.addTasks([e],!1),(a=n.findTask(e.id)).initiatorManager=null==(r=t.tasks.find((t=>t.id===e.id)))?void 0:r.manager);a.common&&n._updateTask(a,e)}))}))}function he(e){var t=this;return new Promise(((n,r)=>{var a=t.tasksId;0===a.length?r(te):setTimeout((()=>n(a)),e)})).then((e=>(f(t,ie,+h(t,ie)+1),fetch(t.options.url,J({},t.options,{method:'post',headers:{'Content-type':'application/x-www-form-urlencoded'},body:encodeURI(e.map((e=>'t[]='+e)).join('&'))})))))}function de(e){return void 0===e&&(e=!1),!1===e?h(this,re):h(this,re).filter((e=>!0===e.options.common))}var pe={writable:!0,value:[]},ve={writable:!0,value:[]},me={ready:'qmc:manager:ready',destroy:'qmc:manager:destroy',statusChange:'qmc:manager:statusChange',fetchStart:'qmc:resolver:start',fetchEnd:'qmc:resolver:end',toString:function(){var e=[];return b(this,(t=>{e.push(t)})),e.join(' ')}},ge={INIT:-1,WAIT:0,EXEC:1,DONE:2,ERROR:3,DELETED:99};function we(e){return(we=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ye(){if('undefined'==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if('function'==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(()=>{}))),!0}catch(e){return!1}}function be(e,t,n){return(be=ye()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&l(a,n.prototype),a}).apply(null,arguments)}function Ee(e){var t='function'==typeof Map?new Map:void 0;return(Ee=function(e){if(null===e||!function(e){return-1!==Function.toString.call(e).indexOf('[native code]')}(e))return e;if('function'!=typeof e)throw new TypeError('Super expression must either be null or a function');if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return be(e,arguments,we(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),l(n,e)})(e)}ge.SET_VISIBLE=[ge.WAIT,ge.EXEC,ge.ERROR,ge.DONE],ge.SET_COMPLETE=[ge.DONE,ge.ERROR,ge.DELETED],ge.is=(e,t)=>e.indexOf(t)>-1;var ke=new WeakMap,Te=function(e){function t(t,n,r){var a;return a=e.call(this,n,r)||this,ke.set(o(a),{writable:!0,value:null}),f(o(a),ke,t),a}return u(t,e),s(t,[{key:'manager',get:function(){return h(this,ke)}}]),t}(Ee(CustomEvent));function Ce(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ne(e,t,n){return function(e,t){if(e!==t)throw new TypeError('Private static access of wrong provenance')}(e,t),function(e,t){if(void 0===e)throw new TypeError('attempted to '+t+' private static field before its declaration')}(n,'get'),function(e,t){if(t.get)return t.get.call(e);return t.value}(e,n)}function xe(e,t,n){if(!t.has(e))throw new TypeError('attempted to get private field on non-instance');return n}var Oe=new WeakMap,Se=new WeakMap,Ae=new WeakSet,Me=function(e){function t(t,n){var r;return r=e.call(this)||this,Ae.add(o(r)),Oe.set(o(r),{writable:!0,value:null}),Ce(o(r),'id',void 0),Ce(o(r),'common',!1),Ce(o(r),'initiatorManager',void 0),Ce(o(r),'progress',0),Ce(o(r),'text',''),Ce(o(r),'title',''),Ce(o(r),'status',ge.INIT),Se.set(o(r),{writable:!0,value:null}),r.id=parseInt(t),f(o(r),Oe,n),r}u(t,e);var n=t.prototype;return n._renderChild=function(e){},n._buildCssClass=function(){return['task-item']},n.cssClassSwitch=function(){var e=xe(this,Ae,Pe).call(this);if('object'==typeof this.manager.options.theme){var n=this.manager.options.theme[this.status]||!1;n&&B(e,t.getClassName('theme-'+n),t.getClassName('theme'))}B(e,Ne(t,t,_e).call(t)[this.status],t.getClassName('status'))},n.refresh=function(e,t){void 0===t&&(t=null),xe(this,Ae,Pe).call(this),t&&this._refreshElements(t,e)},n.getProgressTotal=function(e){void 0===e&&(e='progress');var t=0;return this.hasOwnProperty(e)&&'object'==typeof(t=this[e])&&t.length&&(t=Math.round(t.reduce(((e,t)=>e+t))/t.length,0)),t},n._refreshElements=function(e,t){var n=this,r=this.options.parts;Object.keys(e).forEach((a=>{var i=r[a],s='refreshBasicProperty';if('string'==typeof i){if(i.indexOf('.')>0){var o=i.split('.'),l=o[0],u=o[1];s=l+u[0].toUpperCase()+u.slice(1),i=u}var c=void 0!==n[i]?n[i]:null;c!==(void 0!==t[i]?t[i]:null)&&'function'==typeof n[s='_'+s]&&n[s].call(n,e[a],c,i)}}))},n._refreshBasicProperty=function(e,n,r){if(Array.isArray(n)){var a=t.getClassName('list-'+r),i=$('ul.'+a,e);null===i&&(i=this.createEl('ul',{className:a}),e.append(i)),n.forEach(((e,t)=>{var n=$('li:nth-child('+(t+1)+')',i);null===n?i.append(j('li',{},{},e)):n.innerText!==e&&(n.innerText=e)}))}else e.innerHTML=n},n.getTitle=function(){return''},n.toString=function(){return this.statusText+' '+this.getTitle()},s(t,[{key:'manager',get:function(){return h(this,Oe)}},{key:'element',get:function(){return h(this,Se)}},{key:'options',get:function(){return this.manager.options.taskOptions}},{key:'statusText',get:function(){return this.manager.options.statusText[this.status]||''}}]),t}(V);function Pe(){if(h(this,Se))return h(this,Se);var e=f(this,Se,this.createEl('div',{className:'wrapper'},{'data-task-id':this.id})),t=this.createEl('div',{className:this._buildCssClass()});return this._renderChild(t),e.append(t),e}var We,_e={writable:!0,value:function(){if(this._cssList)return this._cssList;for(var e in this._cssList={},ge)'number'==typeof ge[e]&&(this._cssList[ge[e]]=V.getClassName('status-'+e.toLowerCase()));return this._cssList}},Le=3;a.default.WeakMap||(We=function(){function e(){this.vdata='vdata'+Math.floor(a.default.performance&&a.default.performance.now()||Date.now()),this.data={}}var t=e.prototype;return t.set=function(e,t){var n=e[this.vdata]||Le++;return e[this.vdata]||(e[this.vdata]=n),this.data[n]=t,this},t.get=function(e){var t=e[this.vdata];if(t)return this.data[t]},t.has=function(e){return e[this.vdata]in this.data},t.delete=function(e){var t=e[this.vdata];t&&(delete this.data[t],delete e[this.vdata])},e}());var Re=a.default.WeakMap?new WeakMap:new We;var Ie=new WeakMap,je=new WeakMap,Fe=new WeakMap,ze=new WeakSet,De=function(e){function t(){var n;n=e.call(this)||this,ze.add(o(n)),Ce(o(n),'label',''),Ce(o(n),'className',t.getClassName('progress')),Ce(o(n),'size',null),Ie.set(o(n),{writable:!0,value:[]}),Ce(o(n),'barOptions',{}),je.set(o(n),{writable:!0,value:null}),Fe.set(o(n),{writable:!0,value:null}),Ce(o(n),'isShowGradient',!0);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return J.apply(void 0,[o(n)].concat(a)),n}u(t,e);var n=t.prototype;return n.render=function(){var e=h(this,Fe);if(e instanceof HTMLElement)return e;var n=this.className;return this.size&&(n+=' '+t.getClassName('size-'+this.size)),!1===this.isShowGradient&&(n+=' '+t.getClassName('no-gradient')),e=j('div',{className:n},{},j('div',{className:t.getClassName('progress-items')})),f(this,Fe,e)},n.setProgress=function(e){var n=this,r=h(this,Ie),a=h(this,Fe);e.length,(e='number'==typeof e?[e]:e).forEach(((e,i)=>{r[i]instanceof He?r[i].progress=e:(r[i]=new He(n.barOptions,{progress:e}),a.querySelector('.'+t.getClassName('progress-items')).append(j('div',{className:t.getClassName('progress-item')},{},r[i].render())))}));var i=t.getClassName('more-than-three');!1===F(a,i)&&e.length>3&&z(a,i)},n.setLabel=function(e){e&&(function(e,t,n){if(!t.has(e))throw new TypeError('attempted to get private field on non-instance');return n}(this,ze,qe).call(this).innerHTML=e)},t}(V);function qe(){var e=h(this,je);return e instanceof Element||(f(this,je,e=j('span',{className:De.getClassName('progress-label')},{})),h(this,Fe).append(e)),e}Ce(De,'$classPrefix',null);var Be=new WeakMap,$e=new WeakMap,He=function(){function e(){Be.set(this,{writable:!0,value:!1}),Ce(this,'className','progress-bar'),$e.set(this,{writable:!0,value:0}),Ce(this,'labelText',''),Ce(this,'min',0),Ce(this,'max',100);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];J.apply(void 0,[this].concat(t))}return e.prototype.render=function(){var e=h(this,Be);if(e)return e;var t=[];return!1===this.labelText?t.push(j('span',{className:'sr-only',css:{width:0}},{},this.label)):t=this.label,f(this,Be,e=j('div',{className:De.getClassName(this.className)},{role:'progressbar','aria-valuenow':this.progress,'aria-valuemin':this.min,'aria-valuemax':this.max},t)),e},s(e,[{key:'label',get:function(){var e=this.labelText?this.labelText:'';return this.progress+'% '+e}},{key:'progress',get:function(){return h(this,$e)},set:function(e){f(this,$e,e);var t=this.render();t.setAttribute('aria-valuenow',e),t.childNodes.length>0?t.childNodes[0].textContent=this.label:t.textContent=this.label,t.style.width=e+'%'}}]),e}();function Xe(e,t,n){if(!t.has(e))throw new TypeError('attempted to get private field on non-instance');return n}var Ue=new WeakMap,Ve=new WeakMap,Ge=new WeakMap,Ye=new WeakSet,Ke=function(e){function t(t,n){var r;return void 0===t&&(t=!1),void 0===n&&(n=!1),r=e.call(this)||this,Ye.add(o(r)),Ue.set(o(r),{writable:!0,value:void 0}),Ve.set(o(r),{writable:!0,value:!1}),Ge.set(o(r),{writable:!0,value:!1}),f(o(r),Ve,t),f(o(r),Ge,n),r}return u(t,e),t.prototype.render=function(){var e=h(this,Ue);return e instanceof Element?e:f(this,Ue,this.createEl('span',{className:Xe(this,Ye,Je).call(this)},{},j('span',{},{},['s1','s2','s3'].map((e=>j('span',{className:e}))))))},s(t,[{key:'icon',set:function(e){if(e){var t=h(this,Ve);if(t!==e){var n=h(this,Ue);t&&D(n,t),z(n,e),f(this,Ve,e)}}}},{key:'size',set:function(e){if(e){e=t.getClassName('size-'+e);var n=h(this,Ge);if(n!==e){var r=h(this,Ue);n&&D(r,n),z(r,e),f(this,Ge,e)}}}},{key:'color',set:function(e){H('span[class^=s]',h(this,Ue)).forEach((t=>{t.style.backgroundColor=e}))}}]),t}(V);function Je(){var e='icon-t',t=[];return h(this,Ve)&&(e+=' '+h(this,Ve)),t.push(e),h(this,Ge)&&t.push('size-'+h(this,Ge)),t}function Qe(e,t,n){return function(e,t){if(e!==t)throw new TypeError('Private static access of wrong provenance')}(e,t),n}var Ze={tagName:'button',handler:null,handlerTimoutDelay:500,label:!1,hiddenLabel:'',disabled:!1,size:null,iconName:null,iconHoverName:null,iconSize:null,animatedClick:!0,data:{}},et=new WeakMap,tt=new WeakMap,nt=new WeakMap,rt=new WeakSet,at=function(e){function t(t){var n;return n=e.call(this)||this,rt.add(o(n)),et.set(o(n),{writable:!0,value:void 0}),tt.set(o(n),{writable:!0,value:Ze}),nt.set(o(n),{writable:!0,value:null}),t&&'object'==typeof t&&f(o(n),tt,J({},Ze,t)),n}return u(t,e),t.prototype.render=function(){var e=h(this,et);if(e instanceof Element)return e;var n=this.options,r=[];if(n.iconName){var a=this.icon;r.push(a.render()),a.icon=n.iconName,a.size=n.iconSize}if(n.label&&r.push(j('p',{},{},n.label)),n.hiddenLabel&&r.push(this.createEl('p',{className:'button-hidden'},{},n.hiddenLabel)),n.animatedClick){var i=j('p',{className:'drop'});i.addEventListener('animationend',(function(){D(this,'animate')})),r.push(i)}return e=f(this,et,this.createEl(n.tagName,{className:Qe(t,t,it).call(t,n)},{},r)),this.disabled=n.disabled,function(e,t,n){if(!t.has(e))throw new TypeError('attempted to get private field on non-instance');return n}(this,rt,st).call(this,e,n),e},s(t,[{key:'disabled',set:function(e){var t=this.options;e!==t.disabled&&('button'===t.tagName.toLowerCase()?h(this,et).disabled=e:function(e,t,n){var r=F(e,t);if('function'==typeof n&&(n=n(e,t)),'boolean'!=typeof n&&(n=!r),n!==r)n?z(e,t):D(e,t)}(h(this,et),'disabled'),t.disabled=e)}},{key:'options',get:function(){return h(this,tt)}},{key:'element',get:function(){return this.render()}},{key:'icon',get:function(){var e=h(this,nt);return e instanceof Ke?e:f(this,nt,new Ke)}}]),t}(V);function it(e){var t=['button'];return e.size&&t.push('size-'+e.size),e.hiddenLabel&&t.push('has-hidden'),t}function st(e,t){var n=this;e.addEventListener('click',(n=>{if(t.disabled)return n.stopImmediatePropagation(),!1;t.animatedClick&&Qe(at,at,ot).call(at,e)})),'function'==typeof t.handler&&(t.handlerTimoutDelay>0?e.addEventListener('click',(e=>{setTimeout((()=>t.handler.call(n,e)),t.handlerTimoutDelay)})):e.addEventListener('click',t.handler.bind(this))),t.iconHoverName&&(e.addEventListener('mouseenter',(()=>{!1===t.disabled&&(n.icon.icon=t.iconHoverName)})),e.addEventListener('mouseleave',(()=>{n.icon.icon=t.iconName})))}function ot(e){var t=$('.drop',e);if(t){var n=function(e){if(e&&e.getBoundingClientRect&&e.parentNode){var t=e.getBoundingClientRect(),n={};return['bottom','height','left','right','top','width'].forEach((e=>{void 0!==t[e]&&(n[e]=t[e])})),n.height||(n.height=parseFloat(k(e,'height'))),n.width||(n.width=parseFloat(k(e,'width'))),n}}(e),r=event.pageX-n.width/2-n.left-window.scrollX,a=event.pageY-n.height/2-n.top-window.scrollY;t.style.top=a+'px',t.style.left=r+'px',z(t,'animate')}}function lt(e,t,n){return function(e,t){if(e!==t)throw new TypeError('Private static access of wrong provenance')}(e,t),n}at.Defaults=Ze;var ut={buttons:[],arrange:!1,scaled:!1,selectable:!1,selectIcon:null},ct=new WeakMap,ft=new WeakMap,ht=new WeakSet,dt=function(e){function t(t){var n;n=e.call(this)||this,ht.add(o(n)),Ce(o(n),'buttons',null),ct.set(o(n),{writable:!0,value:ut}),ft.set(o(n),{writable:!0,value:void 0});var r=V.removeOptionsPtoperty('buttons',t,Array);return f(o(n),ct,J({},ut,t)),n.buttons=r.map((e=>new at(e))),n}return u(t,e),t.prototype.render=function(){var e=h(this,ft);return e instanceof Element||(f(this,ft,e=this.createEl('div',{className:lt(t,t,pt).call(t,this.options)},{},this.buttons.map((e=>e.render())))),this.options.selectable&&function(e,t,n){if(!t.has(e))throw new TypeError('attempted to get private field on non-instance');return n}(this,ht,vt).call(this,e)),e},s(t,[{key:'options',get:function(){return h(this,ct)}},{key:'arrange',set:function(e){var n=t.getClassName('arrange'),r=h(this,ft),a=h(this,ct);r&&(e?!1===F(r,n)&&z(r,n):D(r,n)),a.arrange=e}},{key:'selected',set:function(e){var n=t.getClassName('selected'),r=this.options;'number'==typeof e&&(e=this.buttons[e]),e instanceof at&&(this.buttons.forEach((e=>{q(e.element,'data-group-selected'),D(e.element,n)})),z(e.element,n),r.selectIcon&&(e.icon.icon=r.selectIcon,e.options.iconName=r.selectIcon))}}]),t}(V);function pt(e){var t=['button-group'];return e.arrange&&t.push('arrange'),e.scaled&&t.push('scaled'),t}function vt(e){var t=this;e.addEventListener('click',(e=>{var n=e.target.closest('.'+dt.getClassName('button'));t.selected=t.buttons.find((e=>e.element===n))})),e.addEventListener('mouseenter',(e=>{t.$$('.button.selected',e.target).forEach((e=>{!function(e,t,n){e.setAttribute(t,n)}(e,'data-group-selected',!0),D(e,dt.getClassName('selected'))}))})),e.addEventListener('mouseleave',(e=>{t.$$('.button[data-group-selected]',e.target).forEach((e=>{q(e,'data-group-selected'),z(e,dt.getClassName('selected'))}))}))}var mt=new WeakMap,gt=new WeakMap,wt=new WeakMap,yt=new WeakMap,bt=new WeakMap,Et=function(e){function t(t,n,r){var a;return a=e.call(this)||this,mt.set(o(a),{writable:!0,value:[]}),Ce(o(a),'map',{icons:[],actions:[]}),gt.set(o(a),{writable:!0,value:void 0}),wt.set(o(a),{writable:!0,value:null}),yt.set(o(a),{writable:!0,value:null}),bt.set(o(a),{writable:!0,value:null}),f(o(a),gt,t),a.map.icons=n,a.map.actions=r,f(o(a),wt,new Ke('none','big')),f(o(a),yt,a.createEl('span',{className:'status-text'})),r.forEach((e=>{J(e,{data:{task:t}})})),f(o(a),bt,new dt({buttons:r,arrange:!1,scaled:!0})),a}u(t,e);var n=t.prototype;return n.render=function(){var e=h(this,mt);return e.length>0||(e.push(h(this,wt).render()),e.push(h(this,yt)),e.push(h(this,bt).render())),e},n.refresh=function(e){h(this,yt).innerHTML=h(this,gt).statusText,h(this,wt).icon=this.map.icons[e],h(this,bt).buttons.forEach((t=>{var n,r=null==(n=t.options)?void 0:n.enabledWithStatus;if('function'==typeof r&&(r=r.call(t,e)),Array.isArray(r)){if(0===t.options.enabledWithStatus.length)return;t.disabled=-1===t.options.enabledWithStatus.indexOf(e)}else'boolean'==typeof r&&(t.disabled=r)}))},t}(V);function kt(e,t,n){return function(e,t){if(e!==t)throw new TypeError('Private static access of wrong provenance')}(e,t),n}var Tt={iconPlacement:'default',parts:{status:'refresh.status',title:'title',text:'text',error:'errors','progress-wrapper':'refresh.progress'},progress:{label:'',size:'',barOptions:{labelText:!1}},actions:[]},Ct={};Ct[ge.WAIT]='clock',Ct[ge.EXEC]='play',Ct[ge.ERROR]='warning',Ct[ge.DONE]='checked';var Nt=new WeakMap,xt=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,Nt.set(o(t),{writable:!0,value:{}}),t}u(t,e);var n=t.prototype;return n._renderChild=function(e){var n=this,r=h(this,Nt),a=this.options,i=e.appendChild(this.createEl('div',{className:'detail'})),s=e.appendChild(this.createEl('div',{className:'status-wrapper'}));Object.keys(a.parts).forEach((e=>{var o,l=i,u=null;if('progress-wrapper'===e?a.progress?u=new De(a.progress):delete a['progress-wrapper']:'status'===e&&(l=s,u=new Et(n,Ct,a.actions)),r[e]=l.appendChild(n.createEl('div',{className:e},{})),u&&'function'==typeof(null==(o=u)?void 0:o.render)){var c=u.render();c instanceof Element&&(c=[c]),c.forEach((t=>r[e].append(t))),kt(t,t,Ot).call(t,r[e],u)}}))},n.refresh=function(t){e.prototype.refresh.call(this,t,h(this,Nt))},n._buildCssClass=function(){var t=e.prototype._buildCssClass.call(this);return this.options.iconPlacement!==Tt.iconPlacement&&t.push('task-item-'+this.options.iconPlacement),t},n._refreshProgress=function(e,n){var r=kt(t,t,St).call(t,e);r instanceof De&&(r.setLabel(this.getProgressTotal()+'%'),r.setProgress(n))},n._refreshStatus=function(e,n){kt(t,t,St).call(t,e).refresh(n)},n.getTitle=function(){var e,t=this.options.parts.title;return t&&null!=(e=this[t])?e:''},t}(Me);function Ot(e,t){Re.has(e)||Re.set(e,{}),Re.get(e).componet=t}function St(e){if(Re.has(e)){var t=Re.get(e);if(void 0!==t.componet)return t.componet}return null}xt.Defualts=Tt;var At={linear:function(e){return e},quad:function(e){return Math.pow(e,2)},circ:function(e){return 1-Math.sin(Math.acos(e))},back:function(e,t){return void 0===e&&(e=1.5),Math.pow(t,2)*((e+1)*t-e)}},Mt={fadeOut:function(e){this.style.opacity=1-Math.round(100*e)/100},fadeIn:function(e){'none'===this.style.display&&(this.style.display=null),this.style.opacity=Math.round(100*e)/100}};function Pt(e,t){void 0===t&&(t={name:'fadeOut',timing:At.linear,duration:500,delay:0});var n=d({},t);if('function'==typeof n.draw)n.draw.bind(e);else{if('string'!=typeof n.name||'function'!=typeof Mt[n.name])throw new Error('Unknown animation ');n.draw=Mt[n.name].bind(e)}return'number'!=typeof n.delay&&(n.delay=0),n.timing='string'==typeof n.timing&&'function'==typeof At[n.timing]?At[n.timing]:At.linear,new Promise((t=>{setTimeout((()=>{return a=()=>{t(e)},i=(r=n).timing,s=r.draw,o=r.duration,l=performance.now(),void requestAnimationFrame((function e(t){var n=(t-l)/o;n>1&&(n=1);var r=i(n);s(r),n<1?requestAnimationFrame(e):a&&a()}));var r,a,i,s,o,l}),n.delay)}))}function Wt(e,t,n){if(!t.has(e))throw new TypeError('attempted to get private field on non-instance');return n}var _t={common:!1,title:'<h3>Backgrounds tasks</h3>',theme:{'-1':'default'},renderOnEmpty:!0,taskClass:xt,emptyText:'Tasks not provided yet',taskOptions:{},tasks:[],statusText:{},hideAnimation:{name:'fadeOut',duration:1e3,timing:'linear',delay:0},showAnimation:{name:'fadeIn',duration:1e3,timing:'linear',delay:0},tasksAnimation:{hide:{},show:{}},resolver:{url:'queue-reader'}};_t.tasksAnimation.hide[ge.DONE]=J({},_t.hideAnimation,{delay:5e3}),_t.tasksAnimation.hide[ge.ERROR]=J({},_t.hideAnimation,{delay:2e4}),_t.tasksAnimation.show[ge.EXEC]=J({},_t.showAnimation,{duration:500}),_t.tasksAnimation.show[ge.WAIT]=J({},_t.showAnimation,{duration:500}),_t.tasksAnimation.hide[ge.ERROR]=!1,_t.statusText[ge.DONE]='Complete',_t.statusText[ge.ERROR]='Complete with errors',_t.statusText[ge.EXEC]='Processing',_t.statusText[ge.WAIT]='Awaiting';var Lt=new WeakMap,Rt=new WeakMap,It=new WeakMap,jt=new WeakMap,Ft=new WeakSet,zt=new WeakSet,Dt=new WeakSet,qt=function(e){function t(n){var r;r=e.call(this)||this,Dt.add(o(r)),zt.add(o(r)),Ft.add(o(r)),Lt.set(o(r),{writable:!0,value:null}),Rt.set(o(r),{writable:!0,value:{owner:null,wrapper:null,wrapperTasks:null,emptyText:null}}),It.set(o(r),{writable:!0,value:[]}),jt.set(o(r),{writable:!0,value:{}}),h(o(r),Rt).owner=V.removeOptionsPtoperty('element',n);var a=J({},t.Defaults,n);return f(o(r),jt,J({},{taskOptions:a.taskClass.Defualts},a)),f(o(r),Lt,ue.factory(o(r))),r.render(),n.tasks&&void 0!==n.tasks.length&&r.addTasks(n.tasks),setTimeout((()=>{0===r.getTasks().length&&Wt(o(r),Ft,Bt).call(o(r),'show')}),200),r.trigger(me.ready,{bubbles:!0}),r}u(t,e);var n=t.prototype;return n.destroy=function(){this.trigger(me.destroy,{bubbles:!0}),f(this,It,[]),this.ownerElement.remove()},n.trigger=function(e,t,n){if(void 0===t&&(t={}),'object'==typeof n){t.detail={};for(var r=0,a=Object.entries(n);r<a.length;r++){var i=a[r],s=i[0],o=i[1];t.detail[s]=o}}return this.ownerElement.dispatchEvent(new Te(this,e,t))},n.render=function(){var e=this.getTasks(ge.SET_VISIBLE);if(0===e.length&&!1===this.options.renderOnEmpty)return!1;var n=h(this,Rt);if(null===n.wrapper){var r=this.options;n.wrapper=n.owner.appendChild(this.createEl('div',{className:'wrapper'})),0===n.wrapper.childNodes.length&&(r.title&&this.options.title.length>0&&n.wrapper.appendChild(this.createEl('div',{innerHTML:this.options.title,className:'title'})),n.wrapperTasks=n.wrapper.appendChild(this.createEl('div',{className:'tasks'})),r.emptyText.length>0&&(n.emptyText=n.wrapper.appendChild(n.emptyText=this.createEl('div',{className:'empty-wrapper',style:{display:'none'}},{},[this.createEl('span',{className:'empty-text',textContent:r.emptyText})])))),'string'==typeof r.theme&&B(n.wrapper,t.getClassName('theme-'+r.theme),t.getClassName('theme'))}return e.forEach((e=>e.refresh())),!0},n.addTasks=function(e,t){var n=this;void 0===t&&(t=!0),e&&e.length>0&&(f(this,It,h(this,It).concat(e)),Wt(this,Ft,Bt).call(this,'hide').then((()=>{t&&n.resolver.resolve((e=>{e.trigger(me.fetchStart,{bubbles:!0})}),((e,t)=>{e.trigger(me.fetchEnd,{bubbles:!0},{requests:t})}))})))},n._updateTask=function(e,t){if(e.progress!==t.progress||e.status!==t.status||e.text!==t.text||e.title!==t.title){var n=e.status!==t.status,r=J({},e);if((e=J(e,t)).refresh(r),n){if(e.cssClassSwitch(),ge.is([ge.EXEC],e.status),this.trigger(me.statusChange,{bubbles:!0},{task:e,oldStatus:r.status}),ge.is(ge.SET_VISIBLE,e.status)&&null===e.element.parentNode){var a=e.element;a.style.display='none',this.wrapperTasksElement.append(a),Pt(a,Wt(this,zt,$t).call(this,e,'show'))}ge.is(ge.SET_COMPLETE,e.status)&&e.element.parentNode instanceof Element&&this.removeTask(e)}}},n.removeTask=function(e,t){var n=this;void 0===t&&(t=null);var r=this.getTasks();if('number'==typeof e&&(e=r.find((t=>t.id===e))),e instanceof Me){var a=this.getTasks().findIndex((t=>t.id===e.id));if(a>-1)return h(this,It).splice(a,1),Wt(this,Dt,Ht).call(this,e.element,Wt(this,zt,$t).call(this,e)).then((e=>{t&&t(e),0===h(n,It).length&&Wt(n,Ft,Bt).call(n,'show')})),!0}return!1},n.getTasks=function(e){var t=this,n=h(this,It),r=this.options.taskClass;return n.forEach(((e,a)=>{e instanceof Me||('object'==typeof e?n[a]=J(new r(null,t),e):Number.parseInt(e)>0&&(n[a]=new r(e,t)))})),e?('number'==typeof e&&(e=[e]),n.filter((t=>{if(e.indexOf(t.status)>-1)return t}))):n},n.findTask=function(e){var t=this.getTasks().find((t=>t.id===e));return t instanceof Me?t:null},s(t,[{key:'options',get:function(){return h(this,jt)}},{key:'ownerElement',get:function(){return h(this,Rt).owner}},{key:'wrapperElement',get:function(){return h(this,Rt).wrapper}},{key:'wrapperTasksElement',get:function(){return h(this,Rt).wrapperTasks}},{key:'resolver',get:function(){return h(this,Lt)}}]),t}(V);function Bt(e){var t=h(this,Rt).emptyText,n=function(e){var t;return!1!==R(e)&&0!==(''!==(null==(t=e.style)?void 0:t.opacity)?parseFloat(e.style.opacity):1)&&'hidden'!==k(e,'visibility')&&!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)}(t);return R(t)&&(n&&'hide'===e||!1===n&&'show'===e)?Pt(t,this.options[e+'Animation']):Promise.resolve(t)}function $t(e,t){void 0===t&&(t='hide');var n=this.options;return void 0!==n.tasksAnimation[t][e.status]?n.tasksAnimation[t][e.status]:n[t+'Animation']}function Ht(e,t){return void 0===t&&(t=this.options.hideAnimation),!1!==t?Pt(e,t).then((e=>(e.remove(),e))):Promise.resolve(!1)}V.classPrefix='qmc-',qt.TaskAbstract=Me,qt.Button=at,qt.ButtonsGroup=dt,qt.Icon=Ke,qt.Defaults=_t,qt.Events=me,qt.Statuses=ge}(document,window);
